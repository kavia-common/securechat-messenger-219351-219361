{"is_source_file": true, "format": "TypeScript", "description": "This file implements a WebSocket client class (`ChatSocket`) for managing chat communication, including connection management, message handling, and event dispatching within a chat application frontend.", "external_files": ["../config", "../storage", "../types"], "external_methods": ["storage.getToken"], "published": ["chatSocket"], "classes": [{"name": "ChatSocket", "description": "A class managing WebSocket connection, reconnection logic, and event dispatching for chat messages."}], "methods": [{"name": "addListener", "description": "Adds a listener for chat socket events."}, {"name": "emit", "description": "Broadcasts a chat event to all registered listeners."}, {"name": "connect", "description": "Establishes the WebSocket connection, handling authentication and event subscriptions."}, {"name": "scheduleReconnect", "description": "Schedules a reconnection attempt after a delay."}, {"name": "disconnect", "description": "Closes the WebSocket connection and cancels reconnection attempts."}, {"name": "send", "description": "Sends a message payload through the WebSocket if connected."}], "calls": ["storage.getToken", "WebSocket.open", "WebSocket.close", "setTimeout", "clearTimeout", "JSON.stringify", "JSON.parse"], "search-terms": ["chatSocket", "WebSocket connection management", "reconnection logic", "chat message handling", "incoming and outgoing socket events"], "state": 2, "file_id": 11, "knowledge_revision": 54, "git_revision": "", "revision_history": [{"23": ""}, {"54": ""}], "ctags": [{"_type": "tag", "name": "ChatEvent", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^export type ChatEvent =$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "ChatSocket", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^class ChatSocket {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "Listener", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^type Listener = (e: ChatEvent) => void;$/", "language": "TypeScript", "kind": "alias"}, {"_type": "tag", "name": "chatSocket", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^export const chatSocket = new ChatSocket();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^        const data = JSON.parse(msg.data as string) as IncomingSocketEvent;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "encodeURIComponent", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^    const url = `${CONFIG.WS_URL}${token ? `?token=${encodeURIComponent(token)}` : ''}`;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^    const token = await storage.getToken();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^    const url = `${CONFIG.WS_URL}${token ? `?token=${encodeURIComponent(token)}` : ''}`;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/securechat-messenger-219351-219361/whatsapp_frontend/src/ws/chatSocket.ts", "pattern": "/^    const url = `${CONFIG.WS_URL}${token ? `?token=${encodeURIComponent(token)}` : ''}`;$/", "language": "TypeScript", "kind": "constant"}], "hash": "3560876b81e9dd3242c480ff53575803", "format-version": 4, "code-base-name": "whatsapp_frontend", "filename": "whatsapp_frontend/src/ws/chatSocket.ts"}